% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/simulate_data.R
\name{simulate_data}
\alias{simulate_data}
\title{Simulate Microbiome Count Data for Method Evaluation}
\usage{
simulate_data(
  n_samples,
  n_taxa,
  n_diff = 0,
  fold_changes = 2,
  group_sizes = NULL,
  dispersion = 0.3,
  lib_sizes = NULL,
  zero_prob = 0.3,
  phylo_tree = FALSE,
  seed = NULL
)
}
\arguments{
\item{n_samples}{Number of samples to simulate (total across all groups)}

\item{n_taxa}{Number of taxa to simulate}

\item{n_diff}{Number of differentially abundant taxa}

\item{fold_changes}{Numeric vector of fold changes for differential taxa.
If single value, applied to all differential taxa}

\item{group_sizes}{Numeric vector specifying size of each group. Must sum to n_samples.
Default is equal group sizes}

\item{dispersion}{Dispersion parameter for negative binomial distribution (default: 0.3).
Controls the amount of variability in counts}

\item{lib_sizes}{Vector of library sizes. If NULL, randomly generated from
negative binomial distribution}

\item{zero_prob}{Probability of generating zero counts (default: 0.3).
Controls sparsity of the data}

\item{phylo_tree}{Logical; whether to generate a phylogenetic tree (default: FALSE)}

\item{seed}{Random seed for reproducibility}
}
\value{
A list containing:
\itemize{
\item counts: Count matrix (taxa in rows, samples in columns)
\item truth: Logical vector indicating which taxa are truly differential
\item group_info: Factor indicating group membership
\item phylo_tree: Phylogenetic tree (if requested)
}
}
\description{
Generate realistic microbiome count data with controlled differential abundance patterns
for evaluating differential abundance analysis (DAA) methods. Supports various parameters to
simulate different scenarios and data characteristics commonly observed in microbiome studies.
}
\details{
Simulate Microbiome Data

The simulation process:
\enumerate{
\item Generates base abundances from log-normal distribution
\item Applies fold changes to selected taxa in treatment group
\item Generates counts using negative binomial distribution
\item Introduces zeros according to zero_prob
\item Optionally generates phylogenetic tree
}

The function ensures:
\itemize{
\item Realistic abundance distributions
\item Controlled differential abundance patterns
\item Appropriate levels of overdispersion
\item Realistic sparsity patterns
}
}
\examples{
\dontrun{
# Basic simulation with default parameters
sim_data <- simulate_data(
  n_samples = 60,
  n_taxa = 100,
  n_diff = 10
)

# Complex simulation with custom parameters
sim_data <- simulate_data(
  n_samples = 100,
  n_taxa = 200,
  n_diff = 20,
  fold_changes = c(2, 3, 4),
  group_sizes = c(40, 60),
  zero_prob = 0.4,
  phylo_tree = TRUE,
  seed = 123
)

# Access simulated data
dim(sim_data$counts)
table(sim_data$truth)
table(sim_data$group_info)
}

}
